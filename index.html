<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Questionário + Desafio 30 Dias de Hobbies</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f9f9f9;
      color: #333;
    }
    .hidden { display: none; }
    .container {
      max-width: 900px; margin: auto; padding: 20px;
    }
    h1, h2, h3 { text-align: center; }
    button {
      background: #4CAF50; color: white;
      border: none; border-radius: 8px;
      padding: 10px 20px; cursor: pointer;
      margin-top: 10px; transition: 0.3s;
    }
    button:hover { background: #45a049; }
    .question { margin: 20px 0; }
    .chart-container { max-width: 500px; margin: 20px auto; }
    /* Estilos do desafio */
    .hobby-item, .hobby-card {
      border: 1px solid #ddd; border-radius: 12px;
      padding: 15px; margin: 10px 0; background: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .hobby-card header {
      display:flex; justify-content:space-between; align-items:center;
      margin-bottom: 10px;
    }
    .pill {
      background:#eee; padding:3px 8px; border-radius:8px;
      font-size: 0.85em;
    }
    .pill.done { background:#4CAF50; color:white; }
    #progress {
      background:#eee; border-radius:10px;
      overflow:hidden; margin:20px 0; height:24px;
    }
    #progress-bar {
      background:#4CAF50; width:0%; height:100%;
      transition:width 0.4s;
    }
  </style>
</head>
<body>
<div class="container">

  <!-- ================== QUESTIONÁRIO ================== -->
  <section id="view-quiz">
    <h1>Questionário: Uso de Telas</h1>
    <form id="quiz-form">
      <div class="question">
        <label>1. Você sente dificuldade em ficar longe do celular?</label><br>
        <input type="number" name="q1" min="1" max="5" required>
      </div>
      <div class="question">
        <label>2. Você usa o celular antes de dormir?</label><br>
        <input type="number" name="q2" min="1" max="5" required>
      </div>
      <div class="question">
        <label>3. Usa redes sociais como Instagram, YouTube, Spotify, Twitter, WhatsApp ou TikTok diariamente?</label><br>
        <input type="number" name="q3" min="1" max="5" required>
      </div>
      <!-- pode adicionar mais perguntas seguindo o mesmo padrão -->
      <button type="submit">Ver Resultados</button>
    </form>
  </section>

  <!-- ================== RESULTADO QUIZ ================== -->
  <section id="view-quiz-result" class="hidden">
    <h2>Resultado do Questionário</h2>
    <div class="chart-container">
      <canvas id="quizChart"></canvas>
    </div>
    <p id="quiz-interpretation"></p>
    <h3>Deseja iniciar o Desafio de 30 Dias de Hobbies?</h3>
    <button id="btn-go-challenge">Sim, quero começar</button>
  </section>

  <!-- ================== DESAFIO ================== -->
  <section id="view-home" class="hidden">
    <h1>Desafio 30 Dias de Hobbies</h1>
    <p>Você tem 30 dias para realizar 20 hobbies de uma lista com 60 opções.</p>
    <button id="btn-start">Iniciar Desafio</button>
    <div id="resume" style="display:none;grid-template-columns:1fr 1fr;gap:10px;margin-top:20px">
      <div>Progresso: <span id="resume-completed"></span></div>
      <div>Tempo restante: <span id="resume-left"></span></div>
    </div>
  </section>

  <section id="view-select" class="hidden">
    <h2>Escolha seus hobbies</h2>
    <p>Selecione exatamente 20 hobbies:</p>
    <div id="select-grid"></div>
    <p id="count-selected">0/20 selecionados</p>
    <button id="btn-confirm" disabled>Confirmar Seleção</button>
  </section>

  <section id="view-dash" class="hidden">
    <h2>Seus Hobbies</h2>
    <div id="progress">
      <div id="progress-bar"></div>
    </div>
    <p id="progress-text"></p>
    <p id="progress-percent"></p>
    <p>Tempo restante: <span id="countdown"></span></p>
    <div id="dash-grid"></div>
    <button id="btn-reset">Reiniciar</button>
  </section>

  <section id="view-result" class="hidden">
    <h2 id="result-title"></h2>
    <p id="result-msg"></p>
    <button id="btn-try-again">Tentar novamente</button>
    <button id="btn-share">Compartilhar</button>
  </section>

</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
/* ================== QUIZ ================== */
const quizForm = document.getElementById("quiz-form");
quizForm.addEventListener("submit", function(e){
  e.preventDefault();
  const data = new FormData(quizForm);
  let somaGeral = 0, somaApps = 0;

  somaGeral += parseInt(data.get("q1")) || 0;
  somaGeral += parseInt(data.get("q2")) || 0;
  somaApps  += parseInt(data.get("q3")) || 0;

  document.getElementById("view-quiz").classList.add("hidden");
  document.getElementById("view-quiz-result").classList.remove("hidden");

  const ctx = document.getElementById("quizChart");
  new Chart(ctx, {
    type: "pie",
    data: {
      labels: ["Hábitos Gerais", "Uso de Apps"],
      datasets: [{
        data: [somaGeral, somaApps],
        backgroundColor: ["#4CAF50", "#FF5722"]
      }]
    }
  });

  let interpretation = "";
  if(somaGeral+somaApps < 10){
    interpretation = "Seu uso de telas parece equilibrado.";
  } else {
    interpretation = "Atenção: você pode estar gastando muito tempo nas telas.";
  }
  document.getElementById("quiz-interpretation").innerText = interpretation;
});

document.getElementById("btn-go-challenge").addEventListener("click", ()=>{
  document.getElementById("view-quiz-result").classList.add("hidden");
  document.getElementById("view-home").classList.remove("hidden");
});

/* ================== DESAFIO ================== */
/* --- seu código atualizado vai aqui (resumido pela resposta) --- */

// Exemplo mínimo de hobbies para não ficar gigante
const HOBBIES = [
  {name:"Ler um livro", tips:["Escolha um livro curto","Leia 10 páginas por dia"]},
  {name:"Caminhar", tips:["Faça 20 minutos","Tente ao ar livre"]},
  {name:"Meditar", tips:["Comece com 5 min","Use app de meditação"]},
  {name:"Desenhar", tips:["Pegue lápis simples","Desenhe objetos da sua casa"]}
];
const LIMIT=20, DURATION_DAYS=30, STORAGE_KEY='d30-hobbies-state-v1';
const State={startedAt:null,deadline:null,selected:[]};
function saveState(){localStorage.setItem(STORAGE_KEY, JSON.stringify(State));}
function loadState(){try{const s=JSON.parse(localStorage.getItem(STORAGE_KEY));return s;}catch{return null}}
function resetAll(){localStorage.removeItem(STORAGE_KEY);location.reload();}
const $=(q,r=document)=>r.querySelector(q), $$=(q,r=document)=>[...r.querySelectorAll(q)];
const views={home:$('#view-home'),select:$('#view-select'),dash:$('#view-dash'),result:$('#view-result')};
function show(id){Object.values(views).forEach(v=>v.classList.add('hidden'));views[id].classList.remove('hidden');}

$('#btn-start').addEventListener('click', ()=>{
  const existing=loadState();
  if(existing){Object.assign(State,existing);hydrateDashboard();show('dash');return;}
  show('select');renderSelection();
});

function renderSelection(){
  const grid=$('#select-grid');grid.innerHTML='';
  HOBBIES.forEach((h,i)=>{
    const div=document.createElement('div');
    div.className='hobby-item';
    div.innerHTML=`<input type="checkbox" data-idx="${i}" id="h${i}">
      <label for="h${i}">${h.name}</label>`;
    grid.appendChild(div);
  });
  grid.addEventListener('change', onChangeSelection);
}
function onChangeSelection(){
  const checked=$$('#select-grid input:checked');
  if(checked.length>LIMIT){checked[checked.length-1].checked=false;return;}
  $('#count-selected').textContent=`${checked.length}/${LIMIT} selecionados`;
  $('#btn-confirm').disabled=checked.length!==LIMIT;
}
$('#btn-confirm').addEventListener('click', ()=>{
  const idxs=$$('#select-grid input:checked').map(e=>+e.dataset.idx);
  State.selected=idxs.map(i=>({name:HOBBIES[i].name,tips:HOBBIES[i].tips,done:false,doneAt:null}));
  const now=Date.now();State.startedAt=now;State.deadline=now+DURATION_DAYS*86400000;
  saveState();hydrateDashboard();show('dash');
});

function hydrateDashboard(){
  const grid=$('#dash-grid');grid.innerHTML='';
  State.selected.forEach((h,i)=>{
    const card=document.createElement('div');
    card.className='hobby-card';
    card.innerHTML=`<header><strong>${h.name}</strong><span class="pill ${h.done?'done':''}">${h.done?'Concluído':'Pendente'}</span></header>
      <button class="btn" data-idx="${i}">${h.done?'Desfazer':'Concluído ✅'}</button>`;
    grid.appendChild(card);
  });
  grid.addEventListener('click',e=>{
    const b=e.target.closest('button');if(!b)return;
    const i=+b.dataset.idx;const h=State.selected[i];
    h.done=!h.done;h.doneAt=h.done?Date.now():null;saveState();updateProgressUI();hydrateDashboard();
  });
  updateProgressUI();
}
function updateProgressUI(){
  const done=State.selected.filter(h=>h.done).length;
  const pct=Math.round((done/LIMIT)*100);
  $('#progress-bar').style.width=pct+'%';
  $('#progress-text').textContent=`${done}/${LIMIT} concluídos`;
  $('#progress-percent').textContent=pct+'%';
}
</script>
</body>
</html>
